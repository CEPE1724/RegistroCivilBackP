config:
  # URL del servidor a probar (producción)
  target: https://backregistrocivil.appservices.com.ec
  
  # Variables globales
  variables:
    authToken: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJOb21icmUiOiJFQ0VQRURBIiwiaWRVc3VhcmlvIjo0NTgsImlkR3J1cG8iOjEsIkFjdGl2byI6dHJ1ZSwiaWF0IjoxNzY0NzEyNjAyLCJleHAiOjE3NjQ3MjM0MDJ9.W84mLlNZ5_qLHLcTtOf99tiCGjX657ki-ueKkjF9N28"
  
  # Fases de carga progresiva
  phases:
    # Fase 1: Calentamiento - 60 segundos
    # Empieza con 1 usuario/seg y aumenta gradualmente hasta 5 usuarios/seg
    - duration: 60
      arrivalRate: 1
      rampTo: 5
      name: Warm up
    
    # Fase 2: Incremento - 60 segundos
    # Empieza con 5 usuarios/seg y aumenta hasta 10 usuarios/seg
    - duration: 60
      arrivalRate: 5
      rampTo: 10
      name: Ramp up
    
    # Fase 3: Pico de carga - 30 segundos
    # Empieza con 10 usuarios/seg y aumenta hasta 30 usuarios/seg
    - duration: 30
      arrivalRate: 10
      rampTo: 30
      name: Spike
  
  # Plugins para medición y validación
  plugins:
    ensure: {}  # Asegura que se cumplan los umbrales definidos
    apdex: {}  # Mide la satisfacción del usuario basado en tiempos de respuesta
    metrics-by-endpoint: {}  # Métricas separadas por endpoint
  
  # Umbral APDEX: considera aceptable si el tiempo de respuesta es <= 500ms (ajustado para producción)
  apdex:
    threshold: 500
  
  # Umbrales de validación - la prueba falla si no se cumplen (ajustado para producción)
  ensure:
    thresholds:
      - http.response_time.p99: 500  # El 99% de respuestas debe ser < 500ms
      - http.response_time.p95: 300   # El 95% de respuestas debe ser < 300ms

# Escenarios de prueba
scenarios:
  - name: "POST solicitudes web con filtros"
    flow:
      # Loop: repite la petición POST 50 veces por cada usuario virtual
      - loop:
          - post:
              url: '/api/v1/cre-solicitud-web/all-cresolicitudweb'
              headers:
                Authorization: "Bearer {{ authToken }}"
                Content-Type: "application/json"
              json:
                limit: 5
                offset: 0
                fechaInicio: "2025-11-30"
                fechaFin: "2025-12-02"
                bodega: [43,106,118,140,101,1,11,156,63,77,70,57,66,5,128,148,41,95,20,125,212,164,6,123,119,25,145,60,117,111,122,76,162,207,147,121,107,47,103,82,154,155,73,149,99,29,75,31,85,165,166,167,131,168,113,169,94,157,170,171,172,173,161,36,139,174,133,175,176,177,178,179,132,180,181,182,183,184,185,137,163,186,208,187,127,138,81,130,188,189,190,134,191,192,193,194,195,196,197,49,135,114,79,198,199,200,116,136,201,202,203,115,204,205,206,64,96,83,38,37,126,158,159,39,150]
                estado: 0
                vendedor: 0
                analista: 0
                EstadoSolicitud: 0
                EstadoDocumental: 0
                EstadoTelefonica: 0
                EstadoDomicilio: 0
                EstadoLaboral: 0
                operador: 0
        count: 50  # Número de repeticiones por usuario